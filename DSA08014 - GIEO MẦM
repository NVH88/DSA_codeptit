#include<bits/stdc++.h>
using namespace std;

int used[505][505], a[505][505];
queue<pair<int, int>> q;
int dx[] = {+0, +1, -1, +0};
int dy[] = {-1, +0, +0, +1};

int main() {
	int t; cin >> t;
	while(t--) {
		memset(used, 0, sizeof(used));
		int r, c; cin >> r >> c;
		for(int i = 0; i < r; ++i) {
			for(int j = 0; j < c; ++j) {
				cin >> a[i][j];
			}
		}
		for(int i = 0; i < r; ++i) {
			for(int j = 0; j < c; ++j) {
				if(a[i][j] == 2) {
					q.push({i, j});
					used[i][j] = 1;
				}
			}
		}
		while(q.size()) {
			pair<int, int> p = q.front(); q.pop();
			int x = p.first, y = p.second;
			for(int k = 0; k < 4; ++k) {
				int i = x + dy[k], j = y + dx[k];
				if(i >= 0 && i < r && j >= 0 && j < c && a[i][j] == 1) {
					a[i][j] = 2;
					used[i][j] = used[x][y] + 1;
					q.push({i, j});
				}
			}
		}
		int ok = 1, ans = 0;
		for(int i = 0; i < r; ++i) {
			if(!ok) break;
			for(int j = 0; j < c; ++j) {
				ans = max(ans, used[i][j]);
				if(a[i][j] == 1) {
					ok = 0;
					break;
				} 
			}
		}
		if(!ok) cout << -1 << endl;
		else cout << ans - 1 << endl;
	}
}
